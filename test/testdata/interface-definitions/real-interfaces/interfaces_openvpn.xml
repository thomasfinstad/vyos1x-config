<interfaceDefinition>
  <node name="interfaces">
    <children>
      <tagNode name="openvpn" owner="${vyos_conf_scripts_dir}/interfaces_openvpn.py">
        <properties>
          <help>OpenVPN Tunnel Interface</help>
          <priority>460</priority>
          <constraint>
            <regex>vtun[0-9]+</regex>
          </constraint>
          <constraintErrorMessage>OpenVPN tunnel interface must be named vtunN</constraintErrorMessage>
          <valueHelp>
            <format>vtunN</format>
            <description>OpenVPN interface name</description>
          </valueHelp>
          <childSpecification>
            <mutuallyExclusiveChildren>
              <child>server</child>
              <descendant name="mode">
                <value>site-to-site</value>
                <value>client</value>
              </descendant>
            </mutuallyExclusiveChildren>
            <mutuallyExclusiveChildren>
              <descendant name="mode">
                <value>client</value>
              </descendant>
              <descendant name="tls">
                <child>dh-params</child>
              </descendant>
            </mutuallyExclusiveChildren>
            <mutuallyDependantChildren>
              <descendant name="authentication"><child>username</child></descendant>
              <descendant name="authentication"><child>password</child></descendant>
            </mutuallyDependantChildren>
          </childSpecification>
        </properties>
        <children>
<!-- include start from interface/authentication.xml.i -->
<node name="authentication">
  <properties>
    <help>Authentication settings</help>
  </properties>
  <children>
<!-- include start from generic-username.xml.i -->
<leafNode name="username">
  <properties>
    <help>Username used for authentication</help>
    <valueHelp>
      <format>txt</format>
      <description>Username</description>
    </valueHelp>
    <constraint>
      <regex>[[:ascii:]]{1,128}</regex>
    </constraint>
    <constraintErrorMessage>Username is limited to ASCII characters only, with a total length of 128</constraintErrorMessage>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from generic-password.xml.i -->
<leafNode name="password">
  <properties>
    <help>Password used for authentication</help>
    <valueHelp>
      <format>txt</format>
      <description>Password</description>
    </valueHelp>
    <constraint>
      <regex>[[:ascii:]]{1,128}</regex>
    </constraint>
    <constraintErrorMessage>Password is limited to ASCII characters only, with a total length of 128</constraintErrorMessage>
  </properties>
</leafNode>
<!-- include end -->
  </children>
</node>
<!-- include end -->
<!-- include start from generic-description.xml.i -->
<leafNode name="description">
  <properties>
    <help>Description</help>
    <valueHelp>
      <format>txt</format>
      <description>Description</description>
    </valueHelp>
    <constraint>
      <regex>.{0,255}</regex>
    </constraint>
    <constraintErrorMessage>Description too long (limit 255 characters)</constraintErrorMessage>
  </properties>
</leafNode>
<!-- include end -->
          <leafNode name="device-type">
            <properties>
              <help>OpenVPN interface device-type</help>
              <completionHelp>
                <list>tun tap</list>
              </completionHelp>
              <valueHelp>
                <format>tun</format>
                <description>TUN device, required for OSI layer 3</description>
              </valueHelp>
              <valueHelp>
                <format>tap</format>
                <description>TAP device, required for OSI layer 2</description>
              </valueHelp>
              <constraint>
                <regex>(tun|tap)</regex>
              </constraint>
            </properties>
            <defaultValue>tun</defaultValue>
          </leafNode>
<!-- include start from interface/disable.xml.i -->
<leafNode name="disable">
  <properties>
    <help>Administratively disable interface</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
          <node name="encryption">
            <properties>
              <help>Data Encryption settings</help>
            </properties>
            <children>
              <leafNode name="cipher">
                <properties>
                  <help>Standard Data Encryption Algorithm</help>
                  <completionHelp>
                    <list>none 3des aes128 aes128gcm aes192 aes192gcm aes256 aes256gcm</list>
                  </completionHelp>
                  <valueHelp>
                    <format>none</format>
                    <description>Disable encryption</description>
                  </valueHelp>
                  <valueHelp>
                    <format>3des</format>
                    <description>DES algorithm with triple encryption</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aes128</format>
                    <description>AES algorithm with 128-bit key CBC</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aes128gcm</format>
                    <description>AES algorithm with 128-bit key GCM</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aes192</format>
                    <description>AES algorithm with 192-bit key CBC</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aes192gcm</format>
                    <description>AES algorithm with 192-bit key GCM</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aes256</format>
                    <description>AES algorithm with 256-bit key CBC</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aes256gcm</format>
                    <description>AES algorithm with 256-bit key GCM</description>
                  </valueHelp>
                  <constraint>
                    <regex>(none|3des|aes128|aes128gcm|aes192|aes192gcm|aes256|aes256gcm)</regex>
                  </constraint>
                </properties>
              </leafNode>
              <leafNode name="ncp-ciphers">
                <properties>
                  <help>Cipher negotiation list for use in server or client mode</help>
                  <completionHelp>
                    <list>none 3des aes128 aes128gcm aes192 aes192gcm aes256 aes256gcm</list>
                  </completionHelp>
                  <valueHelp>
                    <format>none</format>
                    <description>Disable encryption</description>
                  </valueHelp>
                  <valueHelp>
                    <format>3des</format>
                    <description>DES algorithm with triple encryption</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aes128</format>
                    <description>AES algorithm with 128-bit key CBC</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aes128gcm</format>
                    <description>AES algorithm with 128-bit key GCM</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aes192</format>
                    <description>AES algorithm with 192-bit key CBC</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aes192gcm</format>
                    <description>AES algorithm with 192-bit key GCM</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aes256</format>
                    <description>AES algorithm with 256-bit key CBC</description>
                  </valueHelp>
                  <valueHelp>
                    <format>aes256gcm</format>
                    <description>AES algorithm with 256-bit key GCM</description>
                  </valueHelp>
                  <constraint>
                    <regex>(none|3des|aes128|aes128gcm|aes192|aes192gcm|aes256|aes256gcm)</regex>
                  </constraint>
                  <multi/>
                </properties>
              </leafNode>
            </children>
          </node>
<!-- include start from interface/ipv4-options.xml.i -->
<node name="ip">
  <properties>
    <help>IPv4 routing parameters</help>
  </properties>
  <children>
<!-- include start from interface/adjust-mss.xml.i -->
<!-- https://datatracker.ietf.org/doc/html/rfc6691 -->
<leafNode name="adjust-mss">
  <properties>
    <help>Adjust TCP MSS value</help>
    <completionHelp>
      <list>clamp-mss-to-pmtu</list>
    </completionHelp>
    <valueHelp>
      <format>clamp-mss-to-pmtu</format>
      <description>Automatically sets the MSS to the proper value</description>
    </valueHelp>
    <valueHelp>
      <format>u32:536-65535</format>
      <description>TCP Maximum segment size in bytes</description>
    </valueHelp>
    <constraint>
      <validator name="numeric" argument="--range 536-65535"/>
      <regex>(clamp-mss-to-pmtu)</regex>
    </constraint>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/arp-cache-timeout.xml.i -->
<leafNode name="arp-cache-timeout">
  <properties>
    <help>ARP cache entry timeout in seconds</help>
    <valueHelp>
      <format>u32:1-86400</format>
      <description>ARP cache entry timout in seconds</description>
    </valueHelp>
    <constraint>
      <validator name="numeric" argument="--range 1-86400"/>
    </constraint>
    <constraintErrorMessage>ARP cache entry timeout must be between 1 and 86400 seconds</constraintErrorMessage>
  </properties>
  <defaultValue>30</defaultValue>
</leafNode>
<!-- include end -->
<!-- include start from interface/disable-arp-filter.xml.i -->
<leafNode name="disable-arp-filter">
  <properties>
    <help>Disable ARP filter on this interface</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/disable-forwarding.xml.i -->
<leafNode name="disable-forwarding">
  <properties>
    <help>Disable IP forwarding on this interface</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/enable-directed-broadcast.xml.i -->
<leafNode name="enable-directed-broadcast">
  <properties>
    <help>Enable directed broadcast forwarding on this interface</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/enable-arp-accept.xml.i -->
<leafNode name="enable-arp-accept">
  <properties>
    <help>Enable ARP accept on this interface</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/enable-arp-announce.xml.i -->
<leafNode name="enable-arp-announce">
  <properties>
    <help>Enable ARP announce on this interface</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/enable-arp-ignore.xml.i -->
<leafNode name="enable-arp-ignore">
  <properties>
    <help>Enable ARP ignore on this interface</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/enable-proxy-arp.xml.i -->
<leafNode name="enable-proxy-arp">
  <properties>
    <help>Enable proxy-arp on this interface</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/proxy-arp-pvlan.xml.i -->
<leafNode name="proxy-arp-pvlan">
  <properties>
    <help>Enable private VLAN proxy ARP on this interface</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/source-validation.xml.i -->
<leafNode name="source-validation">
  <properties>
    <help>Source validation by reversed path (RFC3704)</help>
    <completionHelp>
      <list>strict loose disable</list>
    </completionHelp>
    <valueHelp>
      <format>strict</format>
      <description>Enable Strict Reverse Path Forwarding as defined in RFC3704</description>
    </valueHelp>
    <valueHelp>
      <format>loose</format>
      <description>Enable Loose Reverse Path Forwarding as defined in RFC3704</description>
    </valueHelp>
    <valueHelp>
      <format>disable</format>
      <description>No source validation</description>
    </valueHelp>
    <constraint>
      <regex>(strict|loose|disable)</regex>
    </constraint>
  </properties>
</leafNode>
<!-- include end -->
  </children>
</node>
<!-- include end -->
<!-- include start from interface/ipv6-options.xml.i -->
<node name="ipv6">
  <properties>
    <help>IPv6 routing parameters</help>
  </properties>
  <children>
<!-- include start from interface/adjust-mss.xml.i -->
<!-- https://datatracker.ietf.org/doc/html/rfc6691 -->
<leafNode name="adjust-mss">
  <properties>
    <help>Adjust TCP MSS value</help>
    <completionHelp>
      <list>clamp-mss-to-pmtu</list>
    </completionHelp>
    <valueHelp>
      <format>clamp-mss-to-pmtu</format>
      <description>Automatically sets the MSS to the proper value</description>
    </valueHelp>
    <valueHelp>
      <format>u32:536-65535</format>
      <description>TCP Maximum segment size in bytes</description>
    </valueHelp>
    <constraint>
      <validator name="numeric" argument="--range 536-65535"/>
      <regex>(clamp-mss-to-pmtu)</regex>
    </constraint>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/base-reachable-time.xml.i -->
<leafNode name="base-reachable-time">
  <properties>
    <help>Base reachable time in seconds</help>
    <valueHelp>
      <format>u32:1-86400</format>
      <description>Base reachable time in seconds</description>
    </valueHelp>
    <constraint>
      <validator name="numeric" argument="--range 1-86400"/>
    </constraint>
    <constraintErrorMessage>Base reachable time must be between 1 and 86400 seconds</constraintErrorMessage>
  </properties>
  <defaultValue>30</defaultValue>
</leafNode>
<!-- include end -->
<!-- include start from interface/disable-forwarding.xml.i -->
<leafNode name="disable-forwarding">
  <properties>
    <help>Disable IP forwarding on this interface</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/ipv6-accept-dad.xml.i -->
<leafNode name="accept-dad">
  <properties>
    <help>Accept Duplicate Address Detection</help>
    <valueHelp>
      <format>0</format>
      <description>Disable DAD</description>
    </valueHelp>
    <valueHelp>
      <format>1</format>
      <description>Enable DAD</description>
    </valueHelp>
    <valueHelp>
      <format>2</format>
      <description>Enable DAD - disable IPv6 if MAC-based duplicate link-local address found</description>
    </valueHelp>
  </properties>
  <defaultValue>1</defaultValue>
</leafNode>
<!-- include end -->
<!-- include start from interface/ipv6-address.xml.i -->
<node name="address">
  <properties>
    <help>IPv6 address configuration modes</help>
  </properties>
  <children>
<!-- include start from interface/ipv6-address-autoconf.xml.i -->
<leafNode name="autoconf">
  <properties>
    <help>Enable acquisition of IPv6 address using stateless autoconfig (SLAAC)</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/ipv6-address-eui64.xml.i -->
<leafNode name="eui64">
  <properties>
    <help>Prefix for IPv6 address with MAC-based EUI-64</help>
    <valueHelp>
      <format>&lt;h:h:h:h:h:h:h:h/64&gt;</format>
      <description>IPv6 /64 network</description>
    </valueHelp>
    <constraint>
      <validator name="ipv6-eui64-prefix"/>
    </constraint>
    <constraintErrorMessage>EUI64 prefix length must be 64</constraintErrorMessage>
    <multi/>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/ipv6-address-no-default-link-local.xml.i -->
<leafNode name="no-default-link-local">
  <properties>
    <help>Remove the default link-local address from the interface</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
  </children>
</node>
<!-- include end -->
<!-- include start from interface/ipv6-dup-addr-detect-transmits.xml.i -->
<leafNode name="dup-addr-detect-transmits">
  <properties>
    <help>Number of NS messages to send while performing DAD</help>
    <valueHelp>
      <format>u32:0</format>
      <description>Disable Duplicate Address Dectection (DAD)</description>
    </valueHelp>
    <valueHelp>
      <format>u32:1-n</format>
      <description>Number of NS messages to send while performing DAD</description>
    </valueHelp>
    <constraint>
      <validator name="numeric" argument="--non-negative"/>
    </constraint>
  </properties>
  <defaultValue>1</defaultValue>
</leafNode>
<!-- include end -->
<!-- include start from interface/source-validation.xml.i -->
<leafNode name="source-validation">
  <properties>
    <help>Source validation by reversed path (RFC3704)</help>
    <completionHelp>
      <list>strict loose disable</list>
    </completionHelp>
    <valueHelp>
      <format>strict</format>
      <description>Enable Strict Reverse Path Forwarding as defined in RFC3704</description>
    </valueHelp>
    <valueHelp>
      <format>loose</format>
      <description>Enable Loose Reverse Path Forwarding as defined in RFC3704</description>
    </valueHelp>
    <valueHelp>
      <format>disable</format>
      <description>No source validation</description>
    </valueHelp>
    <constraint>
      <regex>(strict|loose|disable)</regex>
    </constraint>
  </properties>
</leafNode>
<!-- include end -->
  </children>
</node>
<!-- include end -->
<!-- include start from interface/mirror.xml.i -->
<node name="mirror">
  <properties>
    <help>Mirror ingress/egress packets</help>
  </properties>
  <children>
    <leafNode name="ingress">
      <properties>
        <help>Mirror ingress traffic to destination interface</help>
        <completionHelp>
          <script>${vyos_completion_dir}/list_interfaces</script>
        </completionHelp>
        <valueHelp>
          <format>txt</format>
          <description>Destination interface name</description>
        </valueHelp>
      </properties>
    </leafNode>
    <leafNode name="egress">
      <properties>
        <help>Mirror egress traffic to destination interface</help>
        <completionHelp>
          <script>${vyos_completion_dir}/list_interfaces</script>
        </completionHelp>
        <valueHelp>
          <format>txt</format>
          <description>Destination interface name</description>
        </valueHelp>
      </properties>
    </leafNode>
  </children>
</node>
<!-- include end -->
          <leafNode name="hash">
            <properties>
              <help>Hashing Algorithm</help>
              <completionHelp>
                <list>md5 sha1 sha256 sha384 sha512</list>
              </completionHelp>
              <valueHelp>
                <format>md5</format>
                <description>MD5 algorithm</description>
              </valueHelp>
              <valueHelp>
                <format>sha1</format>
                <description>SHA-1 algorithm</description>
              </valueHelp>
              <valueHelp>
                <format>sha256</format>
                <description>SHA-256 algorithm</description>
              </valueHelp>
              <valueHelp>
                <format>sha384</format>
                <description>SHA-384 algorithm</description>
              </valueHelp>
              <valueHelp>
                <format>sha512</format>
                <description>SHA-512 algorithm</description>
              </valueHelp>
              <constraint>
                <regex>(md5|sha1|sha256|sha384|sha512)</regex>
              </constraint>
            </properties>
          </leafNode>
          <node name="keep-alive">
            <properties>
              <help>Keepalive helper options</help>
            </properties>
            <children>
              <leafNode name="failure-count">
                <properties>
                  <help>Maximum number of keepalive packet failures</help>
                  <valueHelp>
                    <format>u32:0-1000</format>
                    <description>Maximum number of keepalive packet failures</description>
                  </valueHelp>
                  <constraint>
                    <validator name="numeric" argument="--range 0-1000"/>
                  </constraint>
                </properties>
                <defaultValue>60</defaultValue>
              </leafNode>
              <leafNode name="interval">
                <properties>
                  <help>Keepalive packet interval in seconds</help>
                  <valueHelp>
                    <format>u32:0-600</format>
                    <description>Keepalive packet interval (seconds)</description>
                  </valueHelp>
                  <constraint>
                    <validator name="numeric" argument="--range 0-600"/>
                  </constraint>
                </properties>
                <defaultValue>10</defaultValue>
              </leafNode>
            </children>
          </node>
          <tagNode name="local-address">
            <properties>
              <help>Local IP address of tunnel (IPv4 or IPv6)</help>
              <constraint>
                <validator name="ip-address"/>
              </constraint>
            </properties>
            <children>
              <leafNode name="subnet-mask">
                <properties>
                  <help>Subnet-mask for local IP address of tunnel (IPv4 only)</help>
                  <constraint>
                    <validator name="ipv4-address"/>
                  </constraint>
                </properties>
              </leafNode>
            </children>
          </tagNode>
          <leafNode name="local-host">
            <properties>
              <help>Local IP address to accept connections (all if not set)</help>
              <valueHelp>
                <format>ipv4</format>
                <description>Local IPv4 address</description>
              </valueHelp>
              <valueHelp>
                <format>ipv6</format>
                <description>Local IPv6 address</description>
              </valueHelp>
              <constraint>
                <validator name="ip-address"/>
              </constraint>
            </properties>
          </leafNode>
          <leafNode name="local-port">
            <properties>
              <help>Local port number to accept connections</help>
              <valueHelp>
                <format>u32:1-65535</format>
                <description>Numeric IP port</description>
              </valueHelp>
              <constraint>
                <validator name="numeric" argument="--range 1-65535"/>
              </constraint>
            </properties>
          </leafNode>
          <leafNode name="mode">
            <properties>
              <help>OpenVPN mode of operation</help>
              <completionHelp>
                <list>site-to-site client server</list>
              </completionHelp>
              <valueHelp>
                <format>site-to-site</format>
                <description>Site-to-site mode</description>
              </valueHelp>
              <valueHelp>
                <format>client</format>
                <description>Client in client-server mode</description>
              </valueHelp>
              <valueHelp>
                <format>server</format>
                <description>Server in client-server mode</description>
              </valueHelp>
              <constraint>
                <regex>(site-to-site|client|server)</regex>
              </constraint>
            </properties>
          </leafNode>
          <node name="offload">
            <properties>
              <help>Configurable offload options</help>
            </properties>
            <children>
              <leafNode name="dco">
                <properties>
                  <help>Enable data channel offload on this interface</help>
                  <valueless/>
                </properties>
              </leafNode>
            </children>
          </node>
          <leafNode name="openvpn-option">
            <properties>
              <help>Additional OpenVPN options. You must use the syntax of openvpn.conf in this text-field. Using this without proper knowledge may result in a crashed OpenVPN server. Check system log to look for errors.</help>
              <multi/>
            </properties>
          </leafNode>
          <leafNode name="persistent-tunnel">
            <properties>
              <help>Do not close and reopen interface (TUN/TAP device) on client restarts</help>
              <valueless/>
            </properties>
          </leafNode>
          <leafNode name="protocol">
            <properties>
              <help>OpenVPN communication protocol</help>
              <completionHelp>
                <list>udp tcp-passive tcp-active</list>
              </completionHelp>
              <valueHelp>
                <format>udp</format>
                <description>UDP</description>
              </valueHelp>
              <valueHelp>
                <format>tcp-passive</format>
                <description>TCP and accepts connections passively</description>
              </valueHelp>
              <valueHelp>
                <format>tcp-active</format>
                <description>TCP and initiates connections actively</description>
              </valueHelp>
              <constraint>
                <regex>(udp|tcp-passive|tcp-active)</regex>
              </constraint>
            </properties>
            <defaultValue>udp</defaultValue>
          </leafNode>
          <leafNode name="remote-address">
            <properties>
              <help>IP address of remote end of tunnel</help>
              <valueHelp>
                <format>ipv4</format>
                <description>Remote end IPv4 address</description>
              </valueHelp>
              <valueHelp>
                <format>ipv6</format>
                <description>Remote end IPv6 address</description>
              </valueHelp>
              <constraint>
                <validator name="ip-address"/>
              </constraint>
              <multi/>
            </properties>
          </leafNode>
          <leafNode name="remote-host">
            <properties>
              <help>Remote host to connect to (dynamic if not set)</help>
              <valueHelp>
                <format>ipv4</format>
                <description>IPv4 address of remote host</description>
              </valueHelp>
              <valueHelp>
                <format>ipv6</format>
                <description>IPv6 address of remote host</description>
              </valueHelp>
              <valueHelp>
                <format>txt</format>
                <description>Hostname of remote host</description>
              </valueHelp>
              <multi/>
            </properties>
          </leafNode>
          <leafNode name="remote-port">
            <properties>
              <help>Remote port number to connect to</help>
              <valueHelp>
                <format>u32:1-65535</format>
                <description>Numeric IP port</description>
              </valueHelp>
              <constraint>
                <validator name="numeric" argument="--range 1-65535"/>
              </constraint>
            </properties>
          </leafNode>
          <node name="replace-default-route">
            <properties>
              <help>OpenVPN tunnel to be used as the default route</help>
            </properties>
            <children>
              <leafNode name="local">
                <properties>
                  <help>Tunnel endpoints are on the same subnet</help>
                </properties>
              </leafNode>
            </children>
          </node>
          <node name="server">
            <properties>
              <help>Server-mode options</help>
            </properties>
            <children>
              <tagNode name="client">
                <properties>
                  <help>Client-specific settings</help>
                  <valueHelp>
                    <format>name</format>
                    <description>Client common-name in the certificate</description>
                  </valueHelp>
                </properties>
                <children>
<!-- include start from generic-disable-node.xml.i -->
<leafNode name="disable">
  <properties>
    <help>Disable instance</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
                  <leafNode name="ip">
                    <properties>
                      <help>IP address of the client</help>
                      <valueHelp>
                        <format>ipv4</format>
                        <description>Client IPv4 address</description>
                      </valueHelp>
                      <valueHelp>
                        <format>ipv6</format>
                        <description>Client IPv6 address</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ip-address"/>
                      </constraint>
                      <multi/>
                    </properties>
                  </leafNode>
                  <leafNode name="push-route">
                    <properties>
                      <help>Route to be pushed to the client</help>
                      <valueHelp>
                        <format>ipv4net</format>
                        <description>IPv4 network and prefix length</description>
                      </valueHelp>
                      <valueHelp>
                        <format>ipv6net</format>
                        <description>IPv6 network and prefix length</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ip-prefix"/>
                      </constraint>
                      <multi/>
                    </properties>
                  </leafNode>
                  <leafNode name="subnet">
                    <properties>
                      <help>Subnet belonging to the client (iroute)</help>
                      <valueHelp>
                        <format>ipv4net</format>
                        <description>IPv4 network and prefix length belonging to the client</description>
                      </valueHelp>
                      <valueHelp>
                        <format>ipv6net</format>
                        <description>IPv6 network and prefix length belonging to the client</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ip-prefix"/>
                      </constraint>
                      <multi/>
                    </properties>
                  </leafNode>
                </children>
              </tagNode>
              <node name="client-ip-pool">
                <properties>
                  <help>Pool of client IPv4 addresses</help>
                </properties>
                <children>
<!-- include start from generic-disable-node.xml.i -->
<leafNode name="disable">
  <properties>
    <help>Disable instance</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
                  <leafNode name="start">
                    <properties>
                      <help>First IP address in the pool</help>
                      <constraint>
                        <validator name="ipv4-address"/>
                      </constraint>
                      <valueHelp>
                        <format>ipv4</format>
                        <description>IPv4 address</description>
                      </valueHelp>
                    </properties>
                  </leafNode>
                  <leafNode name="stop">
                    <properties>
                      <help>Last IP address in the pool</help>
                      <constraint>
                        <validator name="ipv4-address"/>
                      </constraint>
                      <valueHelp>
                        <format>ipv4</format>
                        <description>IPv4 address</description>
                      </valueHelp>
                    </properties>
                  </leafNode>
                  <leafNode name="subnet-mask">
                    <properties>
                      <help>Subnet mask pushed to dynamic clients. If not set the server subnet mask will be used. Only used with topology subnet or device type tap. Not used with bridged interfaces.</help>
                      <constraint>
                        <validator name="ipv4-address"/>
                      </constraint>
                      <valueHelp>
                        <format>ipv4</format>
                        <description>IPv4 subnet mask</description>
                      </valueHelp>
                    </properties>
                  </leafNode>
                </children>
              </node>
              <node name="client-ipv6-pool">
                <properties>
                  <help>Pool of client IPv6 addresses</help>
                </properties>
                <children>
                  <leafNode name="base">
                    <properties>
                      <help>Client IPv6 pool base address with optional prefix length</help>
                      <valueHelp>
                        <format>ipv6net</format>
                        <description>Client IPv6 pool base address with optional prefix length (defaults: base = server subnet + 0x1000, prefix length = server prefix length)</description>
                      </valueHelp>
                      <constraint>
                        <validator name="ipv6"/>
                      </constraint>
                    </properties>
                  </leafNode>
<!-- include start from generic-disable-node.xml.i -->
<leafNode name="disable">
  <properties>
    <help>Disable instance</help>
    <valueless/>
  </properties>
</leafNode>
<!-- include end -->
                </children>
              </node>
              <leafNode name="domain-name">
                <properties>
                  <help>DNS suffix to be pushed to all clients</help>
                  <valueHelp>
                    <format>txt</format>
                    <description>Domain Name Server suffix</description>
                  </valueHelp>
                </properties>
              </leafNode>
              <leafNode name="max-connections">
                <properties>
                  <help>Number of maximum client connections</help>
                  <valueHelp>
                    <format>u32:1-4096</format>
                    <description>Number of concurrent clients</description>
                  </valueHelp>
                  <constraint>
                    <validator name="numeric" argument="--range 1-4096"/>
                  </constraint>
                </properties>
              </leafNode>
<!-- include start from name-server-ipv4-ipv6.xml.i -->
<leafNode name="name-server">
  <properties>
    <help>Domain Name Servers (DNS) addresses</help>
    <valueHelp>
      <format>ipv4</format>
      <description>Domain Name Server (DNS) IPv4 address</description>
    </valueHelp>
    <valueHelp>
      <format>ipv6</format>
      <description>Domain Name Server (DNS) IPv6 address</description>
    </valueHelp>
    <constraint>
      <validator name="ip-address"/>
    </constraint>
    <multi/>
  </properties>
</leafNode>
<!-- include end -->
              <tagNode name="push-route">
                <properties>
                  <help>Route to be pushed to all clients</help>
                  <valueHelp>
                    <format>ipv4net</format>
                    <description>IPv4 network and prefix length</description>
                  </valueHelp>
                  <valueHelp>
                    <format>ipv6net</format>
                    <description>IPv6 network and prefix length</description>
                  </valueHelp>
                  <constraint>
                    <validator name="ip-prefix"/>
                  </constraint>
                </properties>
                <children>
                  <leafNode name="metric">
                    <properties>
                      <help>Set metric for this route</help>
                      <valueHelp>
                        <format>u32:0-4294967295</format>
                        <description>Metric for this route</description>
                      </valueHelp>
                      <constraint>
                        <validator name="numeric" argument="--range 0-4294967295"/>
                      </constraint>
                    </properties>
                    <defaultValue>0</defaultValue>
                  </leafNode>
                </children>
              </tagNode>
              <leafNode name="reject-unconfigured-clients">
                <properties>
                  <help>Reject connections from clients that are not explicitly configured</help>
                  <valueless/>
                </properties>
              </leafNode>
              <leafNode name="subnet">
                <properties>
                  <help>Server-mode subnet (from which client IPs are allocated)</help>
                  <valueHelp>
                    <format>ipv4net</format>
                    <description>IPv4 network and prefix length</description>
                  </valueHelp>
                  <valueHelp>
                    <format>ipv6net</format>
                    <description>IPv6 network and prefix length</description>
                  </valueHelp>
                  <constraint>
                    <validator name="ip-prefix"/>
                  </constraint>
                  <multi/>
                </properties>
              </leafNode>
              <leafNode name="topology">
                <properties>
                  <help>Topology for clients</help>
                  <completionHelp>
                    <list>net30 point-to-point subnet</list>
                  </completionHelp>
                  <valueHelp>
                    <format>net30</format>
                    <description>net30 topology</description>
                  </valueHelp>
                  <valueHelp>
                    <format>point-to-point</format>
                    <description>Point-to-point topology</description>
                  </valueHelp>
                  <valueHelp>
                    <format>subnet</format>
                    <description>Subnet topology</description>
                  </valueHelp>
                  <constraint>
                    <regex>(subnet|point-to-point|net30)</regex>
                  </constraint>
                </properties>
                <defaultValue>net30</defaultValue>
              </leafNode>
              <node name="mfa">
                <properties>
                  <help>multi-factor authentication</help>
                </properties>
                <children>
                  <node name="totp">
                    <properties>
                      <help>Time-based one-time passwords</help>
                    </properties>
                    <children>
                      <leafNode name="slop">
                        <properties>
                          <help>Maximum allowed clock slop in seconds</help>
                          <valueHelp>
                            <format>1-65535</format>
                            <description>Seconds</description>
                          </valueHelp>
                          <constraint>
                            <validator name="numeric" argument="--range 1-65535"/>
                          </constraint>
                        </properties>
                        <defaultValue>180</defaultValue>
                      </leafNode>
                      <leafNode name="drift">
                        <properties>
                          <help>Time drift in seconds</help>
                          <valueHelp>
                            <format>1-65535</format>
                            <description>Seconds</description>
                          </valueHelp>
                          <constraint>
                            <validator name="numeric" argument="--range 1-65535"/>
                          </constraint>
                        </properties>
                        <defaultValue>0</defaultValue>
                      </leafNode>
                      <leafNode name="step">
                        <properties>
                          <help>Step value for totp in seconds</help>
                          <valueHelp>
                            <format>1-65535</format>
                            <description>Seconds</description>
                          </valueHelp>
                          <constraint>
                            <validator name="numeric" argument="--range 1-65535"/>
                          </constraint>
                        </properties>
                        <defaultValue>30</defaultValue>
                      </leafNode>
                      <leafNode name="digits">
                        <properties>
                          <help>Number of digits to use for totp hash</help>
                          <valueHelp>
                            <format>1-65535</format>
                            <description>Digits</description>
                          </valueHelp>
                          <constraint>
                            <validator name="numeric" argument="--range 1-65535"/>
                          </constraint>
                        </properties>
                        <defaultValue>6</defaultValue>
                      </leafNode>
                      <leafNode name="challenge">
                        <properties>
                          <help>Expect password as result of a challenge response protocol</help>
                          <completionHelp>
                            <list>disable enable</list>
                          </completionHelp>
                          <valueHelp>
                            <format>disable</format>
                            <description>Disable challenge-response</description>
                          </valueHelp>
                          <valueHelp>
                            <format>enable</format>
                            <description>Enable chalenge-response</description>
                          </valueHelp>
                          <constraint>
                            <regex>(disable|enable)</regex>
                          </constraint>
                        </properties>
                        <defaultValue>enable</defaultValue>
                      </leafNode>
                   </children>
                  </node>
               </children>
              </node>
            </children>
          </node>
          <leafNode name="shared-secret-key">
            <properties>
              <help>Secret key shared with remote end of tunnel</help>
              <completionHelp>
                <path>pki openvpn shared-secret</path>
              </completionHelp>
            </properties>
          </leafNode>
          <node name="tls">
            <properties>
              <help>Transport Layer Security (TLS) options</help>
            </properties>
            <children>
              <leafNode name="auth-key">
                <properties>
                  <help>TLS shared secret key for tls-auth</help>
                  <completionHelp>
                    <path>pki openvpn shared-secret</path>
                  </completionHelp>
                </properties>
              </leafNode>
<!-- include start from pki/certificate.xml.i -->
<leafNode name="certificate">
  <properties>
    <help>Certificate in PKI configuration</help>
    <completionHelp>
      <path>pki certificate</path>
    </completionHelp>
    <valueHelp>
      <format>txt</format>
      <description>Name of certificate in PKI configuration</description>
    </valueHelp>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from pki/ca-certificate-multi.xml.i -->
<leafNode name="ca-certificate">
  <properties>
    <help>Certificate Authority chain in PKI configuration</help>
    <completionHelp>
      <path>pki ca</path>
    </completionHelp>
    <valueHelp>
      <format>txt</format>
      <description>Name of CA in PKI configuration</description>
    </valueHelp>
    <multi/>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from pki/certificate-multi.xml.i -->
<leafNode name="dh-params">
  <properties>
    <help>Diffie Hellman parameters (server only)</help>
    <completionHelp>
      <path>pki dh</path>
    </completionHelp>
  </properties>
</leafNode>
<!-- include end -->
              <leafNode name="crypt-key">
                <properties>
                  <help>Static key to use to authenticate control channel</help>
                  <completionHelp>
                    <path>pki openvpn shared-secret</path>
                  </completionHelp>
                </properties>
              </leafNode>
              <leafNode name="peer-fingerprint">
                <properties>
                  <multi/>
                  <help>Peer certificate SHA256 fingerprint</help>
                  <constraint>
                    <regex>[0-9a-fA-F]{2}:([0-9a-fA-F]{2}:){30}[0-9a-fA-F]{2}</regex>
                  </constraint>
                  <constraintErrorMessage>Peer certificate fingerprint must be a colon-separated SHA256 hex digest</constraintErrorMessage>
                </properties>
              </leafNode>
<!-- include start from tls-version-min.xml.i -->
<leafNode name="tls-version-min">
  <properties>
    <help>Specify the minimum required TLS version</help>
    <completionHelp>
      <list>1.0 1.1 1.2 1.3</list>
    </completionHelp>
    <valueHelp>
      <format>1.0</format>
      <description>TLS v1.0</description>
    </valueHelp>
    <valueHelp>
      <format>1.1</format>
      <description>TLS v1.1</description>
    </valueHelp>
    <valueHelp>
      <format>1.2</format>
      <description>TLS v1.2</description>
    </valueHelp>
    <valueHelp>
      <format>1.3</format>
      <description>TLS v1.3</description>
    </valueHelp>
    <constraint>
      <regex>(1.0|1.1|1.2|1.3)</regex>
    </constraint>
  </properties>
</leafNode>
<!-- include end -->
              <leafNode name="role">
                <properties>
                  <help>TLS negotiation role</help>
                  <completionHelp>
                    <list>active passive</list>
                  </completionHelp>
                  <valueHelp>
                    <format>active</format>
                    <description>Initiate TLS negotiation actively</description>
                  </valueHelp>
                  <valueHelp>
                    <format>passive</format>
                    <description>Wait for incoming TLS connection</description>
                  </valueHelp>
                  <constraint>
                    <regex>(active|passive)</regex>
                  </constraint>
                </properties>
              </leafNode>
            </children>
          </node>
          <leafNode name="use-lzo-compression">
            <properties>
              <help>Use fast LZO compression on this TUN/TAP interface</help>
              <valueless/>
            </properties>
          </leafNode>
<!-- include start from interface/redirect.xml.i -->
<leafNode name="redirect">
  <properties>
    <help>Redirect incoming packet to destination</help>
    <completionHelp>
      <script>${vyos_completion_dir}/list_interfaces</script>
    </completionHelp>
    <valueHelp>
      <format>txt</format>
      <description>Destination interface name</description>
    </valueHelp>
    <constraint>
<!-- include start from constraint/interface-name.xml.i -->
<regex>(bond|br|dum|en|ersp|eth|gnv|ifb|ipoe|lan|l2tp|l2tpeth|macsec|peth|ppp|pppoe|pptp|sstp|sstpc|tun|veth|vti|vtun|vxlan|wg|wlan|wwan)[0-9]+(.\d+)?|lo</regex>
<validator name="file-path --lookup-path /sys/class/net --directory"/>
<!-- include end -->
    </constraint>
  </properties>
</leafNode>
<!-- include end -->
<!-- include start from interface/vrf.xml.i -->
<leafNode name="vrf">
  <properties>
    <help>VRF instance name</help>
    <valueHelp>
      <format>txt</format>
      <description>VRF instance name</description>
    </valueHelp>
    <completionHelp>
      <path>vrf name</path>
    </completionHelp>
<!-- include start from constraint/vrf.xml.i -->
<constraint>
  <validator name="vrf-name"/>
</constraint>
<constraintErrorMessage>VRF instance name must be 15 characters or less and can not\nbe named as regular network interfaces.\nA name must starts from a letter.\n</constraintErrorMessage>
<!-- include end -->
  </properties>
</leafNode>
<!-- include end -->
        </children>
      </tagNode>
    </children>
  </node>
</interfaceDefinition>
